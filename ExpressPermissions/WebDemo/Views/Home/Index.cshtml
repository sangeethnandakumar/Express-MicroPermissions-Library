@{
    ViewData["Title"] = "Home Page";
}

@model ViewModal;

<div class="text-center">
    <h1 class="display-4">Access Control Management With <br />Express.Permission Framework</h1>
    <p>Maintained by Sangeeth Nandakumar</p>
</div>

<div class="row alert" style="margin-top: 50px">
    <div class="col-md-6">
        <div class="text-center">
            <h1 class="display-4">All Users</h1>
        </div>
        <button type="button" class="btn btn-outline-primary">Refresh User List</button>
        <button type="button" class="btn btn-outline-warning" onclick="manage.clearUserSelection()">Clear Current User Selection</button>
        <div class="mt-2">
            <table id="usersTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>Username</th>
                        <th>Full Name</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Id</th>
                        <th>Username</th>
                        <th>Full Name</th>
                        <th>Actions</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
    <div class="col-md-6">
        <div class="text-center">
            <h1 class="display-4">User Permissions</h1>
        </div>
        <button type="button" class="btn btn-outline-primary">Add New Permission</button>
        <button type="button" class="btn btn-outline-secondary">Add New Permission Group</button>
        <div class="alert alert-success mt-2" role="alert" id="infobar" style="display: none">
            Editing Permissions Binded To User - AMRUTHA SUDHAKARAN
        </div>
        <div class="mt-3">
            <table id="permissionviewTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>

<div class="row alert">
    <div class="col-md-6">
        <div class="text-center">
            <h1 class="display-4">Global Permission Groups</h1>
        </div>
        <div class="">
            <table id="permissiongroupviewTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
    <div class="col-md-6">
        <div class="text-center">
            <h1 class="display-4">Global Permissions</h1>
        </div>
        <div class="">
            <table id="permissionTable" class="table table-striped table-bordered" style="width:100%">
                <thead>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
                <tfoot>
                    <tr>
                        <th>Selection</th>
                        <th>Username</th>
                        <th>Full Name</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>

<script>
    //Init
    var usersTable = $('#usersTable').DataTable({
        "columnDefs": [
            {
                "targets": 3,
                "render": function (data, type, row, meta) {
                    return `<button type="button" class="btn btn-outline-info btn-sm" onclick="manage.getPermissionsOfUser(usersTable.row(this).data()[2], usersTable.row(this).data()[1]);">View Permissions</button>`;
                }
            }]
    });
    var permissionviewTable = $('#permissionviewTable').DataTable();
    var permissiongroupviewTable = $('#permissiongroupviewTable').DataTable();
    var permissionTable = $('#permissionTable').DataTable();

    const manage = managementModule;
    manage.refreshUsersList();

    $('#usersTable tbody').on('click', 'tr', function () {
        var fullname = usersTable.row(this).data()[2];
        var username = usersTable.row(this).data()[1];
        manage.getPermissionsOfUser(fullname, username);
    });

</script>
